---
description:
globs:
alwaysApply: false
---
# 用户角色与权限

系统定义了5种用户角色，各自拥有不同权限，这些权限与 [合理化建议业务流程](mdc:.cursor/rules/workflow.mdc) 紧密相关。用户角色及权限定义在 [server/models/User.js](mdc:server/models/User.js) 中，并通过位于 [server/middleware/admin.js](mdc:server/middleware/admin.js) 的权限检查中间件在后端强制执行。

## 角色结构与核心操作权限

### 1. 班组人员 (TEAM_MEMBER)
- **核心权限**：
  - **提交建议**: 创建新的合理化建议，填写所有必要信息并上传附件。
  - **查看个人建议**: 查看本人提交的所有建议及其当前状态和详情。

### 2. 值班主任 (SHIFT_SUPERVISOR)
- **核心权限**：
  - **执行一级审核**: 对其所在班组提交的、状态为"等待一级审核"(`PENDING_FIRST_REVIEW`)的建议进行审核（通过或驳回）。
  - **查看本班组建议**: 查看分配给其所在班组的所有建议的详情和状态。
  - **查看统计报表**: 访问与本班组及整体相关的统计数据报表。

### 3. 安全科管理人员 (SAFETY_ADMIN)
- **核心权限**：
  - **执行二级审核 (安全类)**: 对建议类型为"调度安全类 (SAFETY)"且状态为"等待二级审核"(`PENDING_SECOND_REVIEW`)的建议进行审核（通过或驳回）。
  - **管理建议实施 (安全类)**: 负责更新"调度安全类"建议的实施状态、分配责任人及其他实施相关信息。
  - **查看统计报表**: 访问相关的统计数据报表。

### 4. 运行科管理人员 (OPERATION_ADMIN)
- **核心权限**：
  - **执行二级审核 (非安全类)**: 对所有非"调度安全类"的、且状态为"等待二级审核"(`PENDING_SECOND_REVIEW`)的建议进行审核（通过或驳回）。
  - **管理建议实施 (非安全类)**: 负责更新非"调度安全类"建议的实施状态、分配责任人及其他实施相关信息。
  - **查看统计报表**: 访问相关的统计数据报表。

### 5. 部门经理 (DEPARTMENT_MANAGER)
- **核心权限**：
  - **查看所有建议**: 拥有查看系统中所有建议的权限，不受班组或类型限制。
  - **管理用户**: 执行用户账户的创建、修改、激活/禁用等操作。
  - **执行建议评分**: 对已完成或有价值的建议进行评分。
  - **管理所有建议实施**: 可以管理所有类型建议的实施过程，包括状态更新、责任人分配等。
  - **访问所有功能**: 作为系统的最高权限角色，可以访问所有管理功能和报表。
  - **查看统计报表**: 访问所有层面的统计数据报表。

## 班组结构
系统支持以下班组设置，用于建议的归属和权限划分：
- 甲班 (TEAM_A)
- 乙班 (TEAM_B)
- 丙班 (TEAM_C)
- 丁班 (TEAM_D)
- 无班组 (NONE) - 用于特殊情况或未分配班组的用户。

## 权限控制说明
- 后端通过在 API 路由层面应用权限检查中间件 (例如 `checkShiftSupervisorRole`, `checkSafetyAdminRole` 等) 来确保操作的合法性。
- 前端 UI 会根据当前登录用户的角色和建议的当前状态，动态显示/隐藏操作按钮或页面入口，以提供友好的用户体验并初步过滤非法操作。
